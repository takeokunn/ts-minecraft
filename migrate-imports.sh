#!/bin/bash

# Team A: Domain â†’ Core ç§»è¡Œã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ç½®æ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

echo "ğŸ”„ Starting import path migration from @/domain to @/core/entities..."

# ç½®æ›å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆä½œæˆ
FILES=$(find src -type f -name "*.ts" -o -name "*.tsx" | xargs grep -l "@/domain/\(entity\|block\|block-definitions\)")

if [ -z "$FILES" ]; then
    echo "âœ… No files need updating"
    exit 0
fi

echo "ğŸ“ Found $(echo "$FILES" | wc -l | tr -d ' ') files to update"

# å„ãƒ•ã‚¡ã‚¤ãƒ«ã§ç½®æ›ã‚’å®Ÿè¡Œ
for file in $FILES; do
    echo "  Updating: $file"
    
    # macOSç”¨ã®sedã‚³ãƒãƒ³ãƒ‰ï¼ˆ-i ''ã§ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹ç·¨é›†ï¼‰
    # entity.ts ã®ç½®æ›
    sed -i '' "s|from '@/domain/entity'|from '@/core/entities/entity'|g" "$file"
    sed -i '' "s|from \"@/domain/entity\"|from \"@/core/entities/entity\"|g" "$file"
    
    # block.ts ã®ç½®æ›
    sed -i '' "s|from '@/domain/block'|from '@/core/entities/block'|g" "$file"
    sed -i '' "s|from \"@/domain/block\"|from \"@/core/entities/block\"|g" "$file"
    
    # block-definitions.ts ã®ç½®æ›
    sed -i '' "s|from '@/domain/block-definitions'|from '@/core/entities/block-definitions'|g" "$file"
    sed -i '' "s|from \"@/domain/block-definitions\"|from \"@/core/entities/block-definitions\"|g" "$file"
done

echo ""
echo "âœ… Import path migration completed!"
echo ""
echo "ğŸ“Š Summary:"
echo "  - Files updated: $(echo "$FILES" | wc -l | tr -d ' ')"
echo "  - entity imports: @/domain/entity â†’ @/core/entities/entity"
echo "  - block imports: @/domain/block â†’ @/core/entities/block"
echo "  - block-definitions imports: @/domain/block-definitions â†’ @/core/entities/block-definitions"